<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="


The Complete Instruct_GPT Recipe (Ch 4.2.1)



  Sequential and Two Separate Datasets for RLHF
  #


  
      
          Attribute
          Dataset 1: comes 1st
          Dataset 2: comes next
      
  
  
      
          Size
          ~10K examples (InstructGPT), ~1M modern
          ~100K preference pairs (InstructGPT)
      
      
          Format
          (prompt, good_response) - SINGLE examples
          (prompt, chosen, rejected) - PAIRWISE comparisons
      
      
          Source
          Human-written OR synthetic from strong models
          Human labelers comparing SFT model outputs
      
      
          Purpose
          Teach the model HOW TO RESPOND in chat format
          Teach what GOOD vs BAD responses look like
      
      
          When Collected
          BEFORE preference data collection
          AFTER SFT model exists (use SFT to generate responses)
      
      
          Used to Train
          SFT Model (Ch9)
          Reward Model (Ch7)
      
      
          Example
          { &quot;prompt&quot;: &quot;What is machine learning?&quot;, &quot;response&quot;: &quot;Machine learning is a branch of AI that...&quot; }
          {&quot;prompt&quot;: &quot;What is machine learning?&quot;, &quot;chosen&quot;: &quot;Machine learning is a branch of AI that enables...&quot;, &quot;rejected&quot;: &quot;ML is when computers learn stuff.&quot; }
      
  


  when to prepare 1st and 2nd dataset
  #


         ┌──────────┐
         │  Ch9 SFT │← FIRST: Prepare SFT data
         └───┬──────┘
             │
             ↓
      [Train SFT Model]
             │
             ├──────────────┐
             ↓              ↓
      ┌────────┐     Generate responses
      │ Use in │     for humans to compare
      │  Ch7   │            │
      │  RM    │            ↓
      └───┬────┘     ┌──────────────┐
          │          │Ch6 Pref Data │← SECOND: Collect preferences
          │          └───┬──────────┘
          │              │
          ↓              ↓
         Ch7 RM         Use RM in Ch11
          │              │
          └──────┬───────┘
                 ↓
               Ch11 RL(PPO)



  The Complete InstructGPT Recipe (Ch 4.2.1)
  #


┌─────────────────────────────────────────────────────────┐
│                    Pretrained Base Model                │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ↓
┌────────────────────────────────────────────────────────┐
│  STEP 1: Ch9 SFT                                       │
│  • Prepare single good examples                        │
│  • Train model on (prompt, response) pairs             │
│  • Output: SFT Model (can generate responses)          │
└──────────────────────┬─────────────────────────────────┘
                       │
                       ├──────────────────┐
                       ↓                  ↓
┌──────────────────────────────┐  ┌─────────────────────┐
│  STEP 2a: Ch6 Data Collection│  │ STEP 2b: Ch7 RM     │
│  • Use SFT to generate       │  │ • Start from SFT    │
│  • Humans compare outputs    │─→│ • Train on Ch6 data │
│  • Create preference pairs   │  │ • Output: RM        │
└──────────────────────────────┘  └──────────┬──────────┘
                                             │
                       ┌─────────────────────┘
                       ↓
┌────────────────────────────────────────────────────────┐
│  STEP 3: Ch11 RL Optimization                          │
│  • Policy: SFT Model (from Step 1)                     │
│  • Scorer: Reward Model (from Step 2)                  │
│  • Optimize policy using RM feedback                   │
│  • Output: Final RLHF-trained Model                    │
└────────────────────────────────────────────────────────┘
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://imipark.github.io/ai-workflows/rlhf/rlhf2006/instruct_gpt/">
  <meta property="og:site_name" content="AI Reasoning">
  <meta property="og:title" content="The Complete InstructGPT Recipe (Ch 4.2.1)">
  <meta property="og:description" content="The Complete Instruct_GPT Recipe (Ch 4.2.1) Sequential and Two Separate Datasets for RLHF # Attribute Dataset 1: comes 1st Dataset 2: comes next Size ~10K examples (InstructGPT), ~1M modern ~100K preference pairs (InstructGPT) Format (prompt, good_response) - SINGLE examples (prompt, chosen, rejected) - PAIRWISE comparisons Source Human-written OR synthetic from strong models Human labelers comparing SFT model outputs Purpose Teach the model HOW TO RESPOND in chat format Teach what GOOD vs BAD responses look like When Collected BEFORE preference data collection AFTER SFT model exists (use SFT to generate responses) Used to Train SFT Model (Ch9) Reward Model (Ch7) Example { &#34;prompt&#34;: &#34;What is machine learning?&#34;, &#34;response&#34;: &#34;Machine learning is a branch of AI that...&#34; } {&#34;prompt&#34;: &#34;What is machine learning?&#34;, &#34;chosen&#34;: &#34;Machine learning is a branch of AI that enables...&#34;, &#34;rejected&#34;: &#34;ML is when computers learn stuff.&#34; } when to prepare 1st and 2nd dataset # ┌──────────┐ │ Ch9 SFT │← FIRST: Prepare SFT data └───┬──────┘ │ ↓ [Train SFT Model] │ ├──────────────┐ ↓ ↓ ┌────────┐ Generate responses │ Use in │ for humans to compare │ Ch7 │ │ │ RM │ ↓ └───┬────┘ ┌──────────────┐ │ │Ch6 Pref Data │← SECOND: Collect preferences │ └───┬──────────┘ │ │ ↓ ↓ Ch7 RM Use RM in Ch11 │ │ └──────┬───────┘ ↓ Ch11 RL(PPO) The Complete InstructGPT Recipe (Ch 4.2.1) # ┌─────────────────────────────────────────────────────────┐ │ Pretrained Base Model │ └──────────────────────┬──────────────────────────────────┘ │ ↓ ┌────────────────────────────────────────────────────────┐ │ STEP 1: Ch9 SFT │ │ • Prepare single good examples │ │ • Train model on (prompt, response) pairs │ │ • Output: SFT Model (can generate responses) │ └──────────────────────┬─────────────────────────────────┘ │ ├──────────────────┐ ↓ ↓ ┌──────────────────────────────┐ ┌─────────────────────┐ │ STEP 2a: Ch6 Data Collection│ │ STEP 2b: Ch7 RM │ │ • Use SFT to generate │ │ • Start from SFT │ │ • Humans compare outputs │─→│ • Train on Ch6 data │ │ • Create preference pairs │ │ • Output: RM │ └──────────────────────────────┘ └──────────┬──────────┘ │ ┌─────────────────────┘ ↓ ┌────────────────────────────────────────────────────────┐ │ STEP 3: Ch11 RL Optimization │ │ • Policy: SFT Model (from Step 1) │ │ • Scorer: Reward Model (from Step 2) │ │ • Optimize policy using RM feedback │ │ • Output: Final RLHF-trained Model │ └────────────────────────────────────────────────────────┘">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="ai-workflows">
<title>The Complete InstructGPT Recipe (Ch 4.2.1) | AI Reasoning</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://imipark.github.io/ai-workflows/rlhf/rlhf2006/instruct_gpt/">
<link rel="stylesheet" href="/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.c4e10013ea577c4e1908c5eaa1f1303fe07b484ac90714514291bb2f12aaae31.js" integrity="sha256-xOEAE&#43;pXfE4ZCMXqofEwP&#43;B7SErJBxRRQpG7LxKqrjE=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>AI Reasoning</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>













  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/ai-workflows/" class="">AI Reasoning Stack</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7f3f4cf59430750c2ad109248c8c879b" class="toggle"  />
    <label for="section-7f3f4cf59430750c2ad109248c8c879b" class="flex justify-between">
      <a href="/ai-workflows/data/" class="">Data</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-fc566bddf8394fb4d0c5cff688d2febc" class="toggle"  />
    <label for="section-fc566bddf8394fb4d0c5cff688d2febc" class="flex justify-between">
      <a href="/ai-workflows/data/data-centric-ai/" class="">Data-Centric AI (DCAI)</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cff08f084db31c8732ef81d1fe1c4130" class="toggle"  />
    <label for="section-cff08f084db31c8732ef81d1fe1c4130" class="flex justify-between">
      <a href="/ai-workflows/genai/" class="">GenAI</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-63b806a012c3062adb6281022ca8468f" class="toggle"  />
    <label for="section-63b806a012c3062adb6281022ca8468f" class="flex justify-between">
      <a href="/ai-workflows/genai/5-day-genai-google-2025/" class="">5-Day GenAI with Google 2005</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/5-day-genai-google-2025/day1_foundational_llm_text_generation/" class="">Day 1 - Foundational LLMs &amp; Text Generation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/5-day-genai-google-2025/day1_prompt_engineering/" class="">Day 1 – Prompt Engineering</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/5-day-genai-google-2025/day2_embeddings_vectordb/" class="">Day 2 – Embeddings &amp; Vector Databases</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/5-day-genai-google-2025/day3_generative_agents/" class="">Day 3 – Generative Agents</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/5-day-genai-google-2025/day4_domainspecific_llms/" class="">Day 4 – Domain-Specific LLMs</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/5-day-genai-google-2025/day5_mlops/" class="">Day 5 – MLOps for Generative AI</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/genai/multimodel_llms/" class="">Multimodal LLMs</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-17ba62e37c896ad50105fedeb71549dd" class="toggle"  />
    <label for="section-17ba62e37c896ad50105fedeb71549dd" class="flex justify-between">
      <a href="/ai-workflows/reasoning/" class="">Reasoning</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cd94e161670d28ecff992edf840d76e8" class="toggle"  />
    <label for="section-cd94e161670d28ecff992edf840d76e8" class="flex justify-between">
      <a href="/ai-workflows/reasoning/causality/" class="">Causality</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/reasoning/causality/causal-ai/" class="">Causal AI</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/reasoning/causality/causal-inference/" class="">Causal Inference</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7e468aa05ceb7c844f07a2e754606b76" class="toggle"  />
    <label for="section-7e468aa05ceb7c844f07a2e754606b76" class="flex justify-between">
      <a href="/ai-workflows/reasoning/graph-reasoning/" class="">Graph Reasoning</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/reasoning/graph-reasoning/graphrag/" class="">GraphRAG</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/reasoning/graph-reasoning/knowledge-graphs/" class="">Knowledge Graphs</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1b0623a0f68c821d1e7c5de8bd43d2fb" class="toggle" checked />
    <label for="section-1b0623a0f68c821d1e7c5de8bd43d2fb" class="flex justify-between">
      <a href="/ai-workflows/rlhf/" class="">RLHF</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b1afcafdefac57f3420f64e23d73f05d" class="toggle" checked />
    <label for="section-b1afcafdefac57f3420f64e23d73f05d" class="flex justify-between">
      <a href="/ai-workflows/rlhf/rlhf2006/" class="">RLHF 2006</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/ai-workflows/rlhf/rlhf2006/instruct_gpt_codes_params/" class="">Instruct Gpt Codes Params</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ca53d32fab0e1a54fdf5627349d86bfc" class="toggle"  />
    <label for="section-ca53d32fab0e1a54fdf5627349d86bfc" class="flex justify-between">
      <a href="/ai-workflows/eval/" class="">Eval</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/healthcare/" class="">Healthcare</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-fd1d2eede2c2d7e81bbbc100c0b57829" class="toggle"  />
    <label for="section-fd1d2eede2c2d7e81bbbc100c0b57829" class="flex justify-between">
      <a href="/healthcare/domain_knowledge/" class="">Domain</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-45ba5974905f86df95925365835eadbb" class="toggle"  />
    <label for="section-45ba5974905f86df95925365835eadbb" class="flex justify-between">
      <a href="/healthcare/domain_knowledge/ai-in-healthcare/" class="">AI in Healthcare</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/healthcare/domain_knowledge/ai-in-healthcare/c2_clinical_data/" class="">C2 Clinical Data</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/healthcare/domain_knowledge/ai-in-healthcare/c3_ml_healthcare/" class="">C3 ML Healthcare</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/healthcare/domain_knowledge/ai-in-healthcare/c4_ai_evaluation/" class="">C4 AI Evaluations</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/healthcare/domain_knowledge/ai-in-healthcare/c5_capstone/" class="">C5 Capstone Projects</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9722ba71bf098ab02c3220d6e8d9056f" class="toggle"  />
    <label for="section-9722ba71bf098ab02c3220d6e8d9056f" class="flex justify-between">
      <a href="/healthcare/domain_knowledge/hands-on-healthcare-data/" class="">Hands-On Healthcare Data</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/healthcare/data/" class="">Data</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/healthcare/clinical_ai/" class="">AI Applications</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a href="/ipark/" class="">Inhee Park, PhD - Resume</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>










  
<ul>
  
  <li>
    <a href="https://www.linkedin.com/in/inheepark/"  target="_blank" rel="noopener">
        ╰──LinkedIn
      </a>
  </li>
  
  <li>
    <a href="https://github.com/imipark/"  target="_blank" rel="noopener">
        ╰──GitHub
      </a>
  </li>
  
  <li>
    <a href="/posts/"  target="_blank" rel="noopener">
        ╰──Blog
      </a>
  </li>
  
  <li>
    <a href="https://iparkirk.github.io"  target="_blank" rel="noopener">
        ╰──Old Web
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>The Complete InstructGPT Recipe (Ch 4.2.1)</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#sequential-and-two-separate-datasets-for-rlhf">Sequential and Two Separate Datasets for RLHF</a></li>
            <li><a href="#when-to-prepare-1st-and-2nd-dataset">when to prepare 1st and 2nd dataset</a></li>
            <li><a href="#the-complete-instructgpt-recipe-ch-421">The Complete InstructGPT Recipe (Ch 4.2.1)</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><p align="center">
<img src="/images/AIR_logo.png" alt="AI Reasoning Logo" width="200"/>
<strong style="font-size:1.4rem; color:#374151; display:block; margin-bottom:0.8rem; text-transform:uppercase; letter-spacing:0.0rem;">
The Complete Instruct_GPT Recipe (Ch 4.2.1)
</strong>
</p>
<h3 id="sequential-and-two-separate-datasets-for-rlhf">
  Sequential and Two Separate Datasets for RLHF
  <a class="anchor" href="#sequential-and-two-separate-datasets-for-rlhf">#</a>
</h3>
<table>
  <thead>
      <tr>
          <th>Attribute</th>
          <th>Dataset 1: comes 1st</th>
          <th>Dataset 2: comes next</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Size</td>
          <td>~10K examples (InstructGPT), ~1M modern</td>
          <td>~100K preference pairs (InstructGPT)</td>
      </tr>
      <tr>
          <td>Format</td>
          <td><code>(prompt, good_response)</code> - SINGLE examples</td>
          <td><code>(prompt, chosen, rejected)</code> - PAIRWISE comparisons</td>
      </tr>
      <tr>
          <td>Source</td>
          <td>Human-written OR synthetic from strong models</td>
          <td>Human labelers comparing SFT model outputs</td>
      </tr>
      <tr>
          <td>Purpose</td>
          <td>Teach the model HOW TO RESPOND in chat format</td>
          <td>Teach what GOOD vs BAD responses look like</td>
      </tr>
      <tr>
          <td>When Collected</td>
          <td>BEFORE preference data collection</td>
          <td>AFTER SFT model exists (use SFT to generate responses)</td>
      </tr>
      <tr>
          <td>Used to Train</td>
          <td>SFT Model (Ch9)</td>
          <td>Reward Model (Ch7)</td>
      </tr>
      <tr>
          <td>Example</td>
          <td><code>{ &quot;prompt&quot;: &quot;What is machine learning?&quot;, &quot;response&quot;: &quot;Machine learning is a branch of AI that...&quot; }</code></td>
          <td><code>{&quot;prompt&quot;: &quot;What is machine learning?&quot;, &quot;chosen&quot;: &quot;Machine learning is a branch of AI that enables...&quot;, &quot;rejected&quot;: &quot;ML is when computers learn stuff.&quot; }</code></td>
      </tr>
  </tbody>
</table>
<h3 id="when-to-prepare-1st-and-2nd-dataset">
  when to prepare 1st and 2nd dataset
  <a class="anchor" href="#when-to-prepare-1st-and-2nd-dataset">#</a>
</h3>
<pre style="line-height: 1.0;">
         ┌──────────┐
         │  Ch9 SFT │← FIRST: Prepare SFT data
         └───┬──────┘
             │
             ↓
      [Train SFT Model]
             │
             ├──────────────┐
             ↓              ↓
      ┌────────┐     Generate responses
      │ Use in │     for humans to compare
      │  Ch7   │            │
      │  RM    │            ↓
      └───┬────┘     ┌──────────────┐
          │          │Ch6 Pref Data │← SECOND: Collect preferences
          │          └───┬──────────┘
          │              │
          ↓              ↓
         Ch7 RM         Use RM in Ch11
          │              │
          └──────┬───────┘
                 ↓
               Ch11 RL(PPO)
</pre>
<hr>
<h3 id="the-complete-instructgpt-recipe-ch-421">
  The Complete InstructGPT Recipe (Ch 4.2.1)
  <a class="anchor" href="#the-complete-instructgpt-recipe-ch-421">#</a>
</h3>
<pre style="line-height: 1.0;">
┌─────────────────────────────────────────────────────────┐
│                    Pretrained Base Model                │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ↓
┌────────────────────────────────────────────────────────┐
│  STEP 1: Ch9 SFT                                       │
│  • Prepare single good examples                        │
│  • Train model on (prompt, response) pairs             │
│  • Output: SFT Model (can generate responses)          │
└──────────────────────┬─────────────────────────────────┘
                       │
                       ├──────────────────┐
                       ↓                  ↓
┌──────────────────────────────┐  ┌─────────────────────┐
│  STEP 2a: Ch6 Data Collection│  │ STEP 2b: Ch7 RM     │
│  • Use SFT to generate       │  │ • Start from SFT    │
│  • Humans compare outputs    │─→│ • Train on Ch6 data │
│  • Create preference pairs   │  │ • Output: RM        │
└──────────────────────────────┘  └──────────┬──────────┘
                                             │
                       ┌─────────────────────┘
                       ↓
┌────────────────────────────────────────────────────────┐
│  STEP 3: Ch11 RL Optimization                          │
│  • Policy: SFT Model (from Step 1)                     │
│  • Scorer: Reward Model (from Step 2)                  │
│  • Optimize policy using RM feedback                   │
│  • Output: Final RLHF-trained Model                    │
└────────────────────────────────────────────────────────┘
</pre>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#sequential-and-two-separate-datasets-for-rlhf">Sequential and Two Separate Datasets for RLHF</a></li>
            <li><a href="#when-to-prepare-1st-and-2nd-dataset">when to prepare 1st and 2nd dataset</a></li>
            <li><a href="#the-complete-instructgpt-recipe-ch-421">The Complete InstructGPT Recipe (Ch 4.2.1)</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












